# Malware

Malware's purpose:
- modifying program behavior
- exfiltrating data
- spying on users
- encrypting important files
- denying user access

## Malware Types

Symptoms of computer infection:
- Degraded performance
- Pop-up windows
- Applications automatically launching or shutting down
- Applications not launching
- Accounts locked
- Computer crashing
- Emails sent that weren't recalled
- Changes to homepage or browser settings

Malware is malicious software that disrupts, damages or gains unauthorized access to a computer system.

A computer virus is a type of malicious code or program written to alter the way a computer operates and that is designed to spread from one computer to another.

Virus traits:
- Invoked by a user
- Attached to applications
- Designed to spread to other devices on the network

## Common virus types
- **Resident**
	- virus that infects applications when they are opened
- **Non-resident** 
	- virus that infects executable files when they are not running
- **Multipartite**
	- virus that infects many computers, remains in computer's memory.
- **Direct action**
	- virus that infects all applications, files and folders located in the autoexec.bat (autostart registry path) path.
- **Overwrite**
	- virus that can delete and replace data in files with their own content or code
- **Web scripting**
	- virus that attacks web browser security for injection of malicious code into the browser (Client side scripting)
- **File infector**
	- virus that overwrites files when they are opened
- **Network**
	- virus that cripples network and spreads to devices connected to the network
- **Boot sector**
	- virus that targets the master boot record (MBR) and injects into the hard disk partition

**Browser hijacker** is a person who changes the browser settings and functionality, can import Adware

## Other Malware Types
- **Worm**
	- does not need a host system can spread between systems and network without user interaction.
- **Rootkits (rootkit, DLL injection, driver manipulation)**
	- a collection of computer software designed to enable access to unauthorized computers/parts of software.
	- operates within the kernel of the operating system (**OS**)
	- cannot self-replicate/spread
	- a **DLL injection** attack allows the attacker to execute malicious code by replacing legit DLL files with malicious ones
		- difficult to detect/prevent
	- a **driver manipulation** attacker changes or replaces driver software
		- driver software allows operating system to communicate with hardware devices
- **Keylogger**
	- Malware that records every keystroke the user inputs to gain confidential information
	- spyware, invasive
- **Potentially unwanted program (PUP)**
	- unwanted program that the user might've unknowingly downloaded
	- bloatware, Cortana
- **Spyware**
	- malware that obtains covert information about a user's computer activities, transmits data secretly from the hard drive
- **Adware**
	- hides on a device and displays ads
	- sometimes monitors user behaviour to manipulate ads
- **Dialer**
	- malware that uses dialing features to run up phone bills
- **Adversarial artificial intelligence**
	- malicious input designed to confuse neural networks
- **Ransomware**
	- encrypts/prevents access to data, restored after a paywall
- **Trojan horse virus**
	- virus disguised to look like something it is not
	- hidden within unofficial games, file sharing sites etc.
- **Remote access trojan (RAT)**
	- virus that can remotely control an infected computer
- **Dropper**
	- a type of trojan horse virus designed to install malware on a computer
- **Rogueware/scareware**
	- misleads user into believing there is malware on their computer, prompts them to pay or download antimalware to fix issue.
- **Botnet malware**
	- malware that infects a host through a C&C server.
	- collection of infected computers is known as a botnet
- **Cryptojacking**
	- illegal use of computer resources to mine cryptocurrency

## Malware Attack Vectors and Methods

An **attack vector**, aka threat actor, is a method a bad actor uses to illegally access or inhibit a network, system or facility.
- A specific method of attack
- Category of attack

3 components of an attack vector:
1. Vulnerability
2. Mechanism
3. Pathway

An **attack surface** refers to the total number of entry points that the vector creates to gain unauthorizes access to the target.
- Reducing attack surface = good
	- Stringent password requirements case the attack surface to contract and vice versa

Attack vectors can be physical and electronic. The following is only focused on malware.

### Malware Attack Vectors
- **Watering hole attacks**
	- VULNERABILITY: user
	- PATHWAY: watering hole
	- MECHANISM: malware

Malware infected computers: robot/bot/zombie
- Many bot computers controlled by a C&C server is called a botnet
- An attack by a botnet against a server is a **DDoS**
	- MECHANISM: botnet
	- PATHWAY: internet
	- VULNERABILITY: target server

### Attack Vector Mechanisms
- **Backdoor**
	- an unauthorized way of gaining access to a computer system
- **Logic bomb**
	- A piece of malicious code left lying in wait on a computer that will execute under specific conditions
- **Easter egg**
	- A hidden feature or code that could leave your network and data exposed
		- sometimes shows bad actor attack surface
- **Droppers**
	- programs designed to extract other files from their own code
- **Downloader**
	- trojan horse that installs itself on a computer, then uses the internet to download malware
- **Shellcode**
	- Instructional code that takes control of a compromised computer
- **Code injection**
	- An attack that injects code into an app to change the way it executes
		- typically exploits vulnerability that allows the processing of invalid data

## Links
### Network Security

- [SASE](https://notes.ryancranie.com/Notes/Network%20Security/SASE)

### Threat Landscape

- [The Threat Landscape](https://notes.ryancranie.com/Notes/Threat%20Landscape/The%20Threat%20Landscape)
- [Social Engineering](https://notes.ryancranie.com/Notes/Threat%20Landscape/Social%20Engineering)


### Revision History
001: 2024-09-25 - Initialized Malware.md

---
<b>[Threat Landscape Contents](https://notes.ryancranie.com/Contents/Threat%20Landscape%20Contents)<br>[Home Page](https://notes.ryancranie.com)<br></b>[Ryan Cranie](https://www.ryancranie.com)